{
  "$schema": "./secrets_patterns.schema.json",
  "version": "1.0.0",
  "description": "Security-grade secret detection patterns for BECCA inspector",
  "patterns": [
    {
      "id": "PK_RSA",
      "name": "RSA Private Key",
      "regex": "-----BEGIN RSA PRIVATE KEY-----",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "header_only",
        "show_chars": 40
      },
      "allowlist_context": ["example", "placeholder", "test", "mock", "sample", "docs"]
    },
    {
      "id": "PK_EC",
      "name": "EC Private Key",
      "regex": "-----BEGIN EC PRIVATE KEY-----",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "header_only",
        "show_chars": 40
      },
      "allowlist_context": ["example", "placeholder", "test", "mock"]
    },
    {
      "id": "PK_GENERIC",
      "name": "Generic Private Key",
      "regex": "-----BEGIN PRIVATE KEY-----",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "header_only",
        "show_chars": 40
      },
      "allowlist_context": ["example", "placeholder", "test", "mock"]
    },
    {
      "id": "AWS_ACCESS_KEY",
      "name": "AWS Access Key ID",
      "regex": "AKIA[0-9A-Z]{16}",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": ["example", "placeholder", "test", "mock", "AKIAIOSFODNN7EXAMPLE"]
    },
    {
      "id": "AWS_SECRET_KEY",
      "name": "AWS Secret Access Key",
      "regex": "(?i)(aws_secret_access_key|aws_secret_key)\\s*[=:]\\s*['\"]?([A-Za-z0-9/+=]{40})['\"]?",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": ["example", "placeholder", "test", "wJalrXUtnFEMI/K7MDENG"]
    },
    {
      "id": "GOOGLE_API_KEY",
      "name": "Google API Key",
      "regex": "AIza[0-9A-Za-z\\-_]{35}",
      "severity": "HIGH",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": ["example", "placeholder", "test", "mock"]
    },
    {
      "id": "GOOGLE_SERVICE_ACCOUNT",
      "name": "Google Service Account",
      "regex": "\"type\"\\s*:\\s*\"service_account\"",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "context_only",
        "show_chars": 50
      },
      "allowlist_context": []
    },
    {
      "id": "FIREBASE_PROJECT",
      "name": "Firebase Project Config",
      "regex": "\"project_id\"\\s*:\\s*\"[a-z0-9-]+\"",
      "severity": "LOW",
      "redaction": {
        "strategy": "none"
      },
      "allowlist_context": []
    },
    {
      "id": "OPENAI_API_KEY",
      "name": "OpenAI API Key",
      "regex": "sk-[a-zA-Z0-9]{48}",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 3,
        "show_suffix": 4
      },
      "allowlist_context": ["example", "placeholder", "test"]
    },
    {
      "id": "ANTHROPIC_API_KEY",
      "name": "Anthropic API Key",
      "regex": "sk-ant-[a-zA-Z0-9-]{93}",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 7,
        "show_suffix": 4
      },
      "allowlist_context": ["example", "placeholder", "test"]
    },
    {
      "id": "STRIPE_SECRET_KEY",
      "name": "Stripe Secret Key",
      "regex": "sk_live_[0-9a-zA-Z]{24,}",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 8,
        "show_suffix": 4
      },
      "allowlist_context": ["example", "placeholder", "test"]
    },
    {
      "id": "STRIPE_RESTRICTED_KEY",
      "name": "Stripe Restricted Key",
      "regex": "rk_live_[0-9a-zA-Z]{24,}",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 8,
        "show_suffix": 4
      },
      "allowlist_context": []
    },
    {
      "id": "TWILIO_ACCOUNT_SID",
      "name": "Twilio Account SID",
      "regex": "AC[0-9a-fA-F]{32}",
      "severity": "HIGH",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": []
    },
    {
      "id": "TWILIO_AUTH_TOKEN",
      "name": "Twilio Auth Token",
      "regex": "(?i)(twilio_auth_token|auth_token)\\s*[=:]\\s*['\"]?([a-f0-9]{32})['\"]?",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": []
    },
    {
      "id": "JWT_TOKEN",
      "name": "JWT Token",
      "regex": "eyJ[A-Za-z0-9_-]+\\.eyJ[A-Za-z0-9_-]+\\.[A-Za-z0-9_-]+",
      "severity": "HIGH",
      "redaction": {
        "strategy": "header_only",
        "show_chars": 20
      },
      "allowlist_context": ["example", "test", "mock"]
    },
    {
      "id": "POSTGRES_URL",
      "name": "PostgreSQL Connection String",
      "regex": "postgres://[^\\s\"']+:[^\\s\"']+@[^\\s\"']+",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "mask_credentials"
      },
      "allowlist_context": ["example", "localhost", "127.0.0.1"]
    },
    {
      "id": "MONGODB_URL",
      "name": "MongoDB Connection String",
      "regex": "mongodb(\\+srv)?://[^\\s\"']+:[^\\s\"']+@[^\\s\"']+",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "mask_credentials"
      },
      "allowlist_context": ["example", "localhost", "127.0.0.1"]
    },
    {
      "id": "GITHUB_TOKEN",
      "name": "GitHub Personal Access Token",
      "regex": "ghp_[0-9a-zA-Z]{36}",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": []
    },
    {
      "id": "GITHUB_OAUTH",
      "name": "GitHub OAuth Token",
      "regex": "gho_[0-9a-zA-Z]{36}",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": []
    },
    {
      "id": "SLACK_TOKEN",
      "name": "Slack Token",
      "regex": "xox[baprs]-[0-9]{10,13}-[0-9a-zA-Z-]+",
      "severity": "HIGH",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": []
    },
    {
      "id": "GENERIC_API_KEY",
      "name": "Generic API Key Pattern",
      "regex": "(?i)(api[_-]?key|apikey)\\s*[=:]\\s*['\"]?([a-zA-Z0-9_-]{20,})['\"]?",
      "severity": "MEDIUM",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": ["example", "placeholder", "test", "YOUR_API_KEY", "xxx"]
    },
    {
      "id": "GENERIC_SECRET",
      "name": "Generic Secret Pattern",
      "regex": "(?i)(?<![a-zA-Z])(secret|password|passwd|pwd)\\s*[=:]\\s*['\"`]([^'\"`\\s]{8,})['\"`]",
      "severity": "MEDIUM",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 2,
        "show_suffix": 2
      },
      "allowlist_context": ["example", "placeholder", "test", "YOUR_", "xxx", "changeme", "password123", "process.env"],
      "exclude_patterns": [
        ":\\s*string",
        ":\\s*String",
        ":\\s*\\(",
        "setPassword",
        "clientSecret",
        "webhookSecret",
        "process\\.env"
      ],
      "notes": "Requires quotes around value to avoid matching type signatures"
    },
    {
      "id": "SENDGRID_API_KEY",
      "name": "SendGrid API Key",
      "regex": "SG\\.[a-zA-Z0-9_-]{22}\\.[a-zA-Z0-9_-]{43}",
      "severity": "CRITICAL",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 3,
        "show_suffix": 4
      },
      "allowlist_context": []
    },
    {
      "id": "ELEVENLABS_API_KEY",
      "name": "ElevenLabs API Key",
      "regex": "[a-f0-9]{32}",
      "severity": "MEDIUM",
      "redaction": {
        "strategy": "prefix_suffix",
        "show_prefix": 4,
        "show_suffix": 4
      },
      "allowlist_context": [],
      "requires_context": ["elevenlabs", "xi_api_key", "voice"]
    }
  ],
  "file_targets": {
    "always_scan": [
      ".env*",
      "*.env",
      "firebase*.json",
      "serviceAccount*.json",
      "*credentials*.json",
      "config/*.json",
      "config/*.yaml",
      "config/*.toml",
      ".github/workflows/*.yml",
      "Dockerfile",
      "docker-compose*.yml"
    ],
    "scan_in_source": [
      "*.ts",
      "*.tsx",
      "*.js",
      "*.jsx",
      "*.py",
      "*.go",
      "*.java"
    ],
    "scan_in_build": [
      ".next/static/**/*.js",
      "dist/**/*.js",
      "build/**/*.js"
    ]
  },
  "entropy_detection": {
    "enabled": true,
    "min_length": 32,
    "min_entropy": 4.5,
    "context_words": ["token", "secret", "auth", "bearer", "apikey", "api_key", "password", "credential"],
    "exclude_patterns": ["base64_padding_only", "repeated_chars"]
  }
}
